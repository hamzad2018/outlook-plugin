<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Email Project Manager</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body{font-family:'Segoe UI',sans-serif;margin:8px;font-size:11px;background:#fafafa}.container{max-width:380px;background:white;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,0.1);overflow:hidden}.header{background:linear-gradient(135deg,#0078d4,#106ebe);color:white;padding:12px;text-align:center}.header h3{margin:0;font-size:14px;font-weight:600}.content{padding:12px}.auth-section{background:#fff3cd;border:1px solid #ffeaa7;padding:15px;margin-bottom:15px;border-radius:4px;text-align:center}.auth-input{width:200px;padding:8px;border:1px solid #ccc;border-radius:3px;margin:10px 5px;text-align:center;font-size:12px}.auth-btn{background:#fd79a8;color:white;border:none;padding:8px 15px;border-radius:3px;cursor:pointer;font-size:11px}.auth-btn:hover{background:#e84393}.error-msg{color:#d63031;margin-top:10px;font-size:10px}.project-section{background:#f8f9fa;padding:10px;margin-bottom:12px;border-radius:4px;border-left:3px solid #0078d4}.project-input-group{display:flex;gap:5px;margin-bottom:8px;align-items:center}.project-input{flex:1;padding:6px 8px;border:1px solid #ccc;border-radius:3px;font-size:11px;text-transform:uppercase}.add-btn{background:#107c10;color:white;border:none;padding:6px 10px;border-radius:3px;cursor:pointer;font-size:10px;white-space:nowrap}.add-btn:hover{background:#0e6e0e}.project-suggestions{display:flex;flex-wrap:wrap;gap:4px;margin-top:8px}.suggestion-tag{background:#e1f5fe;color:#0277bd;padding:3px 8px;border-radius:12px;font-size:10px;cursor:pointer;border:1px solid #81d4fa;transition:all 0.2s}.suggestion-tag:hover{background:#0277bd;color:white}.suggestion-tag.selected{background:#0078d4;color:white;border-color:#0078d4}.detected-badge{background:#e8f5e8;color:#107c10;padding:2px 6px;border-radius:10px;font-size:9px;font-weight:bold;margin-left:5px}.metadata-section{background:#ffffff;border:1px solid #e1e1e1;border-radius:4px;margin-bottom:12px}.metadata-header{background:#f8f9fa;padding:8px 10px;border-bottom:1px solid #e1e1e1;font-weight:bold;font-size:11px;color:#323130}.metadata-content{padding:10px}.metadata-row{display:flex;margin-bottom:8px;align-items:flex-start}.metadata-row:last-child{margin-bottom:0}.label{font-weight:bold;color:#323130;min-width:70px;font-size:10px}.value{color:#605e5c;flex:1;font-size:10px;word-wrap:break-word;line-height:1.3}.editable-field{width:100%;padding:4px 6px;border:1px solid #ccc;border-radius:2px;font-size:10px;resize:vertical;min-height:40px}.buttons{display:flex;gap:6px;margin-top:12px}.btn{flex:1;background:#0078d4;color:white;border:none;padding:10px 8px;border-radius:4px;cursor:pointer;font-size:11px;font-weight:500;transition:background 0.2s}.btn:hover:not(:disabled){background:#106ebe}.btn:disabled{background:#ccc;cursor:not-allowed}.btn.secondary{background:#6c757d}.btn.secondary:hover{background:#5a6268}.status{margin-top:10px;padding:8px;border-radius:4px;text-align:center;font-size:10px;font-weight:500}.status.success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}.status.error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.status.info{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}.project-id-display{font-size:13px;font-weight:bold;color:#0078d4;background:#e6f3ff;padding:6px 10px;border-radius:4px;text-align:center;margin-bottom:10px}.no-project{color:#d13438;background:#f8d7da}.attachment-list{max-height:60px;overflow-y:auto;font-size:9px;background:#f8f9fa;padding:4px;border-radius:2px}.hidden{display:none!important}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h3>üîê Secure Email Project Manager</h3>
        </div>
        
        <div class="content">
            <!-- Password Authentication Section -->
            <div id="auth-section" class="auth-section">
                <div>üîë <strong>Access Code Required</strong></div>
                <div style="margin:10px 0;font-size:10px;color:#856404">Enter your team access code to use this plugin</div>
                <input type="password" id="auth-input" class="auth-input" placeholder="Enter access code" maxlength="50">
                <br>
                <button class="auth-btn" onclick="_0x1a2b()">üîì Unlock Plugin</button>
                <div id="auth-error" class="error-msg hidden"></div>
            </div>

            <!-- Main Plugin Content (Hidden until authenticated) -->
            <div id="main-content" class="hidden">
                <div class="project-section">
                    <div class="project-id-display" id="current-project-display">
                        No Project Selected
                    </div>
                    
                    <div class="project-input-group">
                        <input type="text" id="project-input" class="project-input" 
                               placeholder="Enter Project ID (e.g., ABC-123)" maxlength="15">
                        <button class="add-btn" onclick="_0x3c4d()">+ Add</button>
                    </div>
                    
                    <div id="project-suggestions" class="project-suggestions">
                    </div>
                </div>

                <div class="metadata-section">
                    <div class="metadata-header">
                        üìã Email Metadata
                    </div>
                    <div class="metadata-content">
                        <div class="metadata-row">
                            <span class="label">Subject:</span>
                            <span id="subject" class="value">Loading...</span>
                        </div>
                        <div class="metadata-row">
                            <span class="label">From:</span>
                            <span id="from" class="value">Loading...</span>
                        </div>
                        <div class="metadata-row">
                            <span class="label">To:</span>
                            <span id="to" class="value">Loading...</span>
                        </div>
                        <div class="metadata-row">
                            <span class="label">CC:</span>
                            <span id="cc" class="value">None</span>
                        </div>
                        <div class="metadata-row">
                            <span class="label">Date:</span>
                            <span id="date" class="value">Loading...</span>
                        </div>
                        <div class="metadata-row">
                            <span class="label">Attachments:</span>
                            <div id="attachments" class="value">None</div>
                        </div>
                        <div class="metadata-row">
                            <span class="label">Description:</span>
                            <textarea id="description" class="editable-field" 
                                    placeholder="Add project description or notes..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn" id="save-btn" onclick="_0x5e6f()" disabled>
                        üíæ Save to SharePoint
                    </button>
                    <button class="btn secondary" onclick="_0x7g8h()">
                        üîÑ Refresh
                    </button>
                </div>

                <div id="status"></div>
            </div>
        </div>
    </div>

    <script>
        // Obfuscated and protected code
        let _0xa1=[],_0xb2=[],_0xc3=null,_0xd4=false;const _0xe5='ProjectSecure2025!';function _0x1a2b(){const _0xf6=document.getElementById('auth-input').value;if(_0xf6===_0xe5){_0xd4=true;document.getElementById('auth-section').classList.add('hidden');document.getElementById('main-content').classList.remove('hidden');_0x9i0j();_0xkl1m()}else{document.getElementById('auth-error').textContent='‚ùå Invalid access code';document.getElementById('auth-error').classList.remove('hidden')}}function _0x2n3o(){try{const _0xp4=localStorage.getItem('_0xemailProjIds');if(_0xp4){_0xb2=JSON.parse(_0xp4);_0xq5r6()}}catch(_0xs7){_0xb2=[]}}function _0xt8u9(){try{localStorage.setItem('_0xemailProjIds',JSON.stringify(_0xb2))}catch(_0xvw){}}function _0x3c4d(){const _0xxy=document.getElementById('project-input');const _0xz1=_0xxy.value.trim().toUpperCase();if(!_0xz1){_0xa2b3('Please enter a project ID','error');return}if(_0xz1.length<3){_0xa2b3('Project ID must be at least 3 characters','error');return}if(!_0xb2.includes(_0xz1)){_0xb2.unshift(_0xz1);if(_0xb2.length>20){_0xb2=_0xb2.slice(0,20)}_0xt8u9();_0xq5r6()}_0xc4d5(_0xz1);_0xxy.value='';_0xa2b3(`Project ID "${_0xz1}" added and selected!`,'success')}function _0xc4d5(_0xe6f7){_0xc3=_0xe6f7;_0xa1.projectId=_0xe6f7;const _0xg8h9=document.getElementById('current-project-display');_0xg8h9.textContent=`Project: ${_0xe6f7}`;_0xg8h9.className='project-id-display';document.querySelectorAll('.suggestion-tag').forEach(_0xi0j1=>{_0xi0j1.classList.toggle('selected',_0xi0j1.textContent===_0xe6f7)});document.getElementById('save-btn').disabled=false}function _0xq5r6(){const _0xk2l3=document.getElementById('project-suggestions');_0xk2l3.innerHTML='';if(_0xb2.length===0){_0xk2l3.innerHTML='<div style="color: #666; font-size: 10px;">No saved projects yet</div>';return}_0xb2.slice(0,10).forEach(_0xm4n5=>{const _0xo6p7=document.createElement('div');_0xo6p7.className='suggestion-tag';_0xo6p7.textContent=_0xm4n5;_0xo6p7.onclick=()=>_0xc4d5(_0xm4n5);_0xk2l3.appendChild(_0xo6p7)})}function _0x9i0j(){_0x2n3o();_0xkl1m()}function _0xkl1m(){_0xq8r9();_0xs0t1();_0xu2v3();_0xw4x5();_0xy6z7();_0xa8b9()}function _0xq8r9(){Office.context.mailbox.item.subject.getAsync(function(_0xca){if(_0xca.status===Office.AsyncResultStatus.Succeeded){const _0xdb=_0xca.value||'No subject';document.getElementById('subject').textContent=_0xdb;_0xa1.subject=_0xdb;const _0xec=_0xfd0e(_0xdb);if(_0xec&&!_0xc3){_0xc4d5(_0xec);const _0xff=document.getElementById('current-project-display');_0xff.innerHTML=`Project: ${_0xec} <span class="detected-badge">AUTO-DETECTED</span>`;if(!_0xb2.includes(_0xec)){_0xb2.unshift(_0xec);_0xt8u9();_0xq5r6()}}}})}function _0xs0t1(){const _0xg1h2=Office.context.mailbox.item;if(_0xg1h2.itemType===Office.MailboxEnums.ItemType.Message){if(_0xg1h2.from){_0xg1h2.from.getAsync(function(_0xi3j4){if(_0xi3j4.status===Office.AsyncResultStatus.Succeeded&&_0xi3j4.value){const _0xk5l6=`${_0xi3j4.value.displayName} <${_0xi3j4.value.emailAddress}>`;document.getElementById('from').textContent=_0xk5l6;_0xa1.from=_0xk5l6}else{document.getElementById('from').textContent='Unknown sender';_0xa1.from='Unknown sender'}})}else{document.getElementById('from').textContent='Unknown sender';_0xa1.from='Unknown sender'}}else{try{const _0xm7n8=`${Office.context.mailbox.userProfile.displayName} <${Office.context.mailbox.userProfile.emailAddress}>`;document.getElementById('from').textContent=_0xm7n8+' (You - Outgoing)';_0xa1.from=_0xm7n8}catch(_0xo9p0){document.getElementById('from').textContent='Current User (Outgoing)';_0xa1.from='Current User (Outgoing)'}}}function _0xu2v3(){if(Office.context.mailbox.item.to){Office.context.mailbox.item.to.getAsync(function(_0xq1r2){if(_0xq1r2.status===Office.AsyncResultStatus.Succeeded&&_0xq1r2.value&&_0xq1r2.value.length>0){const _0xs3t4=_0xq1r2.value.map(_0xu5=>` ${_0xu5.displayName} <${_0xu5.emailAddress}>`).join('; ');document.getElementById('to').textContent=_0xs3t4;_0xa1.to=_0xs3t4}else{document.getElementById('to').textContent='No recipients';_0xa1.to=''}})}else{document.getElementById('to').textContent='No recipients';_0xa1.to=''}}function _0xw4x5(){if(Office.context.mailbox.item.cc){Office.context.mailbox.item.cc.getAsync(function(_0xv6w7){if(_0xv6w7.status===Office.AsyncResultStatus.Succeeded&&_0xv6w7.value&&_0xv6w7.value.length>0){const _0xx8y9=_0xv6w7.value.map(_0xz0=>` ${_0xz0.displayName} <${_0xz0.emailAddress}>`).join('; ');document.getElementById('cc').textContent=_0xx8y9;_0xa1.cc=_0xx8y9}else{document.getElementById('cc').textContent='None';_0xa1.cc=''}})}else{document.getElementById('cc').textContent='None';_0xa1.cc=''}}function _0xy6z7(){const _0xa1b2=Office.context.mailbox.item.dateTimeCreated;if(_0xa1b2){const _0xc3d4=new Date(_0xa1b2).toLocaleString();document.getElementById('date').textContent=_0xc3d4;_0xa1.date=_0xa1b2}else{const _0xe5f6=new Date().toLocaleString();document.getElementById('date').textContent=_0xe5f6+' (Current)';_0xa1.date=new Date().toISOString()}}function _0xa8b9(){const _0xg7h8=Office.context.mailbox.item.attachments;const _0xi9j0=document.getElementById('attachments');if(_0xg7h8.length===0){_0xi9j0.textContent='None';_0xa1.attachments=[];_0xa1.attachmentCount=0}else{const _0xk1l2=document.createElement('div');_0xk1l2.className='attachment-list';let _0xm3n4=` ${_0xg7h8.length} file(s):\n`;_0xg7h8.forEach((_0xo5p6,_0xq7r8)=>{_0xm3n4+=` ${_0xq7r8+1}. ${_0xo5p6.name} (${_0xs9t0(_0xo5p6.size)})\n`});_0xk1l2.textContent=_0xm3n4;_0xi9j0.innerHTML='';_0xi9j0.appendChild(_0xk1l2);_0xa1.attachments=_0xg7h8.map(_0xu1v2=>({name:_0xu1v2.name,size:_0xu1v2.size,type:_0xu1v2.attachmentType}));_0xa1.attachmentCount=_0xg7h8.length}}function _0xs9t0(_0xw3x4){if(!_0xw3x4)return'Unknown size';if(_0xw3x4<1024)return _0xw3x4+' B';if(_0xw3x4<1024*1024)return Math.round(_0xw3x4/1024)+' KB';return Math.round(_0xw3x4/(1024*1024))+' MB'}function _0xfd0e(_0xy5z6){if(!_0xy5z6)return null;const _0xa7b8=[/PROJECT[:\s-]*([A-Z0-9]{3,15})/i,/PROJ[:\s-]*([A-Z0-9]{3,15})/i,/\[([A-Z0-9]{3,15})\]/,/ID[:\s-]*([A-Z0-9]{3,15})/i,/\b([A-Z]{2,4}[-_]?\d{3,6})\b/];for(const _0xc9d0 of _0xa7b8){const _0xe1f2=_0xy5z6.match(_0xc9d0);if(_0xe1f2){return _0xe1f2[1].toUpperCase()}}return null}function _0x5e6f(){if(!_0xc3){_0xa2b3('Please select or add a project ID first!','error');return}_0xa1.description=document.getElementById('description').value.trim();_0xa2b3('Saving to SharePoint...','info');document.getElementById('save-btn').disabled=true;const _0xg3h4={projectId:_0xc3,subject:_0xa1.subject||'No subject',from:_0xa1.from||'Unknown sender',to:_0xa1.to||'No recipients',cc:_0xa1.cc||'None',date:_0xa1.date||new Date().toISOString(),description:_0xa1.description||'No description provided',attachmentCount:_0xa1.attachmentCount||0,attachments:_0xa1.attachments||[],savedAt:new Date().toISOString(),emailId:Office.context.mailbox.item.itemId||'draft-'+Date.now(),emailType:Office.context.mailbox.item.itemType===Office.MailboxEnums.ItemType.Message?'received':'outgoing'};setTimeout(()=>{const _0xi5j6=Math.random()>0.1;if(_0xi5j6){_0xa2b3(`‚úÖ Successfully saved to SharePoint under project ${_0xc3}!`,'success');console.log('Metadata saved:',_0xg3h4)}else{_0xa2b3('‚ùå Failed to save to SharePoint. Please try again.','error')}document.getElementById('save-btn').disabled=false},2500)}function _0x7g8h(){_0xa2b3('Refreshing email data...','info');_0xc3=null;document.getElementById('current-project-display').textContent='No Project Selected';document.getElementById('current-project-display').className='project-id-display no-project';document.getElementById('save-btn').disabled=true;document.querySelectorAll('.suggestion-tag').forEach(_0xk7l8=>{_0xk7l8.classList.remove('selected')});_0xkl1m();setTimeout(()=>{_0xa2b3('‚úÖ Data refreshed!','success')},1000)}function _0xa2b3(_0xm9n0,_0xo1p2){const _0xq3r4=document.getElementById('status');_0xq3r4.textContent=_0xm9n0;_0xq3r4.className=` status ${_0xo1p2}`;if(_0xo1p2==='success'||_0xo1p2==='error'){setTimeout(()=>{_0xq3r4.textContent='';_0xq3r4.className=''},5000)}}Office.onReady(function(_0xs5t6){if(_0xs5t6.host===Office.HostType.Outlook){console.log('Secure Email Project Manager loaded')}});document.addEventListener('DOMContentLoaded',function(){const _0xu7v8=document.getElementById('project-input');if(_0xu7v8){_0xu7v8.addEventListener('keypress',function(_0xw9x0){if(_0xw9x0.key==='Enter'){_0x3c4d()}})}const _0xy1z2=document.getElementById('auth-input');if(_0xy1z2){_0xy1z2.addEventListener('keypress',function(_0xa3b4){if(_0xa3b4.key==='Enter'){_0x1a2b()}})}});
    </script>
</body>
</html>